<form method="post" id="page-6-form">
	<label>Tekst: <input type="text" name="todoText" /></label>
	<label>Dato: <input type="text" name="todoDate" /></label>
	<input type="submit" class="btn" value="OK" />
</form>


<ul>
	<li><span class="date">01.01.2014</span> Plukke opp fyrverkerirester fra nyttårsfeiringen
		<div class="actions pull-right">
			<i class="icon icon-edit"></i>
			<i class="icon icon-star"></i>
 			<i class="icon icon-ok"></i>
 			<i class="icon icon-remove"></i>
		</div>
	</li>
	<li><span class="date">03.01.2014</span> Pakke ned julepynt og juletre. Husk å legge juletrefoten på det lure stedet.		<div class="actions pull-right">
			<i class="icon icon-edit"></i>
			<i class="icon icon-star"></i>
 			<i class="icon icon-ok"></i>
 			<i class="icon icon-remove"></i>
		</div>
	</li>
	<li><span class="date">03.01.2014</span> Brygge øl etter oppskrift fra Kjartan og Andreas		<div class="actions pull-right">
			<i class="icon icon-edit"></i>
			<i class="icon icon-star"></i>
 			<i class="icon icon-ok"></i>
 			<i class="icon icon-remove"></i>
		</div>
	</li>
	<li><span class="date">03.01.2014</span> Kjøpe bjørkepinner og sette pinnekjøttet i vann 12 timer før koking		<div class="actions pull-right">
			<i class="icon icon-edit"></i>
			<i class="icon icon-star"></i>
 			<i class="icon icon-ok"></i>
 			<i class="icon icon-remove"></i>
		</div>
	</li>
	<li><span class="date">04.01.2014</span> Vaske og polere bilen, sjekke dekktrykket, 2.5 foran og 2.8 bak		<div class="actions pull-right">
			<i class="icon icon-edit"></i>
			<i class="icon icon-star"></i>
 			<i class="icon icon-ok"></i>
 			<i class="icon icon-remove"></i>
		</div>
	</li>
	<li><span class="date">04.01.2014</span> Sette pinnekjøttet på kok, hente ved og fyre i ovnen		<div class="actions pull-right">
			<i class="icon icon-edit"></i>
			<i class="icon icon-star"></i>
 			<i class="icon icon-ok"></i>
 			<i class="icon icon-remove"></i>
		</div>
	</li>
	<li><span class="date">04.01.2014</span> Pugge lorem ipsum dolor sit amet		<div class="actions pull-right">
			<i class="icon icon-edit"></i>
			<i class="icon icon-star"></i>
 			<i class="icon icon-ok"></i>
 			<i class="icon icon-remove"></i>
		</div>
	</li>
	<li><span class="date">04.01.2014</span> Pugge lorem ipsum dolor sit amet, consectetur adipisicing elit, sed 		<div class="actions pull-right">
			<i class="icon icon-edit"></i>
			<i class="icon icon-star"></i>
 			<i class="icon icon-ok"></i>
 			<i class="icon icon-remove"></i>
		</div>
	</li>
</ul>

<script type="text/javascript">

$('#page-6-form').submit(function (e) {
	e.stopPropagation();
	e.preventDefault();
	var text = $(this).find('[name=todoText]').val();
	var date = moment($(this).find('[name=todoDate]').val(), 'DD.MM.YYYY');
	var itemCount = $('.page-6 li').length;
	var $newItem = $('<li><span class="date">' + date.format('DD.MM.YYYY') + '</span> ' + text + '<div class="actions pull-right"><i class="icon icon-edit"></i><i class="icon icon-star"></i><i class="icon icon-ok"></i><i class="icon icon-remove"></i></div></li>');

	$('.page-6 li').each(function(index) {
		var itemDate = moment($(this).find('.date').text(), 'DD.MM.YYYY');
		if(date.isBefore(itemDate)){
			$(this).before($newItem);
			return false;
		}else if(index === itemCount-1){
			$(this).after($newItem);
		}
	});
	setTimeout(function(){
		$newItem.addClass('animating');
	}, 0);
	
	return false;
})

$('.icon-remove').click(function() {
	$(this).closest('li').addClass('deleting').on('webkitAnimationEnd', function () {
		$(this).remove();
	});
});

</script>